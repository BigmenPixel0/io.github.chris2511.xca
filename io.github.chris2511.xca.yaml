app-id: io.github.chris2511.xca
runtime: org.kde.Platform
runtime-version: '5.15'
sdk: org.kde.Sdk
finish-args:
  # X11 + XShm access
  - --share=ipc
  - --socket=x11
  # Wayland access
  - --socket=wayland
  # Needs to talk to the network:
  - --share=network
  # Needs to save files locally
  - --filesystem=xdg-documents
command: /app/bin/xca
modules:
  - name: xca
    buildsystem: simple
    build-commands:
      - ./bootstrap
      - "STRIP=: ./configure --prefix=/app"
      - make -j$(nproc)
      - make install
    sources:
      - type: git
        url: https://github.com/chris2511/xca.git
        tag: RELEASE.2.3.0
        commit: 79510a24c52c6678e2daf3e5dbedb0841343ecea
      - type: file
        path: "io.github.chris2511.xca.appdata.xml"
      - type: patch
        path: 0001-unset-werror.patch
    post-install:
      - install -Dm644 io.github.chris2511.xca.appdata.xml /app/share/appdata/io.github.chris2511.xca.appdata.xml
      - install -Dm644 img/xca-64x64.png /app/share/app-info/icons/flatpak/64x64/io.github.chris2511.xca.png
      - install -Dm644 img/xca-32x32.png /app/share/app-info/icons/flatpak/32x32/io.github.chris2511.xca.png
      - install -Dm644 img/xca-16x16.png /app/share/app-info/icons/flatpak/16x16/io.github.chris2511.xca.png
